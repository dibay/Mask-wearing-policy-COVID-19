#descriptive analysis for the plasma bile acids:
describe(Tauro_w_Muricholic_acid)
#loading data
roswell = read.csv("/Users/sdibay/Documents/Post-doc/roswell/Roswell bileacidstohutch.csv",stringsAsFactors = FALSE, na.strings = c("NA","N/A","."))
#descriptive analysis for the plasma bile acids:
describe(Tauro_w_Muricholic_acid)
#descriptive analysis for the plasma bile acids:
summarize(roswell$Tauro_w_Muricholic_acid)
#descriptive analysis for the plasma bile acids:
table(roswell$Tauro_w_Muricholic_acid)
#descriptive analysis for the plasma bile acids:
summary(roswell$Tauro_w_Muricholic_acid)
summary(roswell$Tauro_a_Muricholic_acid)
#descriptive analysis for the plasma bile acids:
summary(roswell$Tauro_w_Muricholic_acid_st)
summary(roswell$Tauro_w_Muricholic_acid_st)
summary(roswell$Tauro_a_Muricholic_acid_st)
summary(roswell$Tauro_b_Muricholic_acid)
summary(roswell$Tauro_b_Muricholic_acid_st)
summary(roswell$Tauroursodeoxycholic_acid)
summary(roswell$Tauro_b_Muricholic_acid_st)
summary(roswell$Tauroursodeoxycholic_acid_st)
summary(roswell$Tauroursodeoxycholic_acid_st)
summary(roswell$Tauroursodeoxycholic_acid_st)
summary(roswell$Taurocholic_acid)
summary(roswell$Taurocholic_acid_st)
summary(roswell$Taurocholic_acid_st)
summary(roswell$Taurocholic_acid)
summary(roswell$w_Muricholic_acid_st)
summary(roswell$w_Muricholic_acid)
summary(roswell$Glycoursodeoxycholic_acid)
summary(roswell$Glycohyodeoxycholic_acid)
summary(roswell$a_Muricholic_acid)
summary(roswell$Glycocholic_acid)
summary(roswell$b_Muricholic_acid)
roswell %>%
select(everything()) %>%  # replace to your needs
summarise_all(funs(sum(is.na(.))))
#loading data
roswell = read.csv("/Users/sdibay/Documents/Post-doc/roswell/Roswell bileacidstohutch.csv",stringsAsFactors = FALSE, na.strings = c("NA","N/A","."))
roswell %>%
select(everything()) %>%  # replace to your needs
summarise_all(funs(sum(is.na(.))))
library("dyplyr")
library("dplyr")
roswell %>%
select(everything()) %>%  # replace to your needs
summarise_all(funs(sum(is.na(.))))
a= roswell %>%
select(everything()) %>%  # replace to your needs
summarise_all(funs(sum(is.na(.))))
View(a)
f <- ggplot(data = roswell, aes(x=DietaryPattern, y=value)) +
geom_boxplot(aes(fill=DietaryPattern))
library(ggplot2)
library(dplyr)
library(reshape2)
install.packages("wesanderson")
library(wesanderson)
f <- ggplot(data = roswell, aes(x=DietaryPattern, y=value)) +
geom_boxplot(aes(fill=DietaryPattern))
f
f <- ggplot(data = roswell, aes(x=DietaryPattern, y=value))
f
ggplot(stack(roswell), aes(x = ind, y = values)) +
geom_boxplot()
roswell([7:15])
print\
prtint(roswell[7:15])
print(roswell[7:15])
ggplot(stack(roswell[7:15]), aes(x = ind, y = values)) +
geom_boxplot()
roswell[7:15][is.na(roswell[7:15])] = 0
ggplot(stack(roswell[7:15]), aes(x = ind, y = values)) +
geom_boxplot()
b= ggplot(stack(roswell[7:15]), aes(x = ind, y = values)) +
geom_boxplot()
b
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 4))
b
theme_set(theme_gray(base_size = 5))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 4))
b
theme_set(theme_gray(base_size = 6))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 4))
b
roswell[7:15][is.na(roswell[7:15])] = 0
theme_set(theme_gray(base_size = 6))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 6))
b
drop(b)
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 6))
b
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 6))
b+ xlab("Plasam Bile Acids") + ylab("")
b
drop(b)
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+theme(axis.text = element_text(size = 6))
b+ xlab("Plasam Bile Acids") + ylab("")
b
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+ xlab("Plasam Bile Acids") + ylab("")
b+theme(axis.text = element_text(size = 6))
b
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot()
b+ xlab("Plasam Bile Acids") + ylab("")
b
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:10]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
theme_set(theme_gray(base_size = 8))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
theme_set(theme_gray(base_size = 4))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
4
b
theme_set(theme_gray(base_size = 5))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
roswell[7:15][is.na(roswell[7:15])] = 0
theme_set(theme_gray(base_size = 5))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
roswell[7:17][is.na(roswell[7:17])] = 0
theme_set(theme_gray(base_size = 5))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
roswell[7:51][is.na(roswell[7:51])] = 0
theme_set(theme_gray(base_size = 5))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
roswell[7:51][is.na(roswell[7:51])] = 0
theme_set(theme_gray(base_size = 4))
b= ggplot(stack(roswell[7:17]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
b
theme_set(theme_gray(base_size = 4))
c= ggplot(stack(roswell[18:28]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Plasam Bile Acids") + ylab("")
c
theme_set(theme_gray(base_size = 4))
d= ggplot(stack(roswell[18:28]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Stool Bile Acids") + ylab("")
d
theme_set(theme_gray(base_size = 4))
d= ggplot(stack(roswell[29:39]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Stool Bile Acids") + ylab("")
d
theme_set(theme_gray(base_size = 4))
e= ggplot(stack(roswell[40:51]), aes(x = ind, y = values)) +
geom_boxplot() + xlab("Stool Bile Acids") + ylab("")
e
View(a)
write.csv(a, "~/Documents/Post-doc/roswell/missing-values.csv")
f <- summarise_each(roswell[7:51], funs(mean))
f <- across(roswell[7:51], funs(mean))
f <- summarise_across(roswell[7:51], funs(mean))
f <- summarise_each(roswell[7:51], funs(mean))
f
View(f)
f <- summarise_each(roswell[7:51], funs(mean))
write.csv(f, "~/Documents/Post-doc/roswell/mean-values.csv")
BactoCarb_metabolomics= read.csv("/Users/sdibay/Documents/Post-doc/Cairo/BactoCARB-Metabolomics.csv",stringsAsFactors = FALSE, na.strings = c("NA","N/A","."))
BactoCarb_Metab$PptID <- gsub("-", "", BactoCarb_metabolomics$PptID)
library(lme4)
library(limma)
library(lme4)##for lme
library(lmerTest)## for lme pvalue
library(plyr)
BactoCarb_metabolomics= read.csv("/Users/sdibay/Documents/Post-doc/Cairo/BactoCARB-Metabolomics.csv",stringsAsFactors = FALSE, na.strings = c("NA","N/A","."))
BactoCarb_Metab$PptID <- gsub("-", "", BactoCarb_metabolomics$PptID)
colnames(BactoCarb_Metab)
BactoCarb_Metab= read.csv("/Users/sdibay/Documents/Post-doc/Cairo/BactoCARB-Metabolomics.csv",stringsAsFactors = FALSE, na.strings = c("NA","N/A","."))
BactoCarb_Metab$PptID <- gsub("-", "", BactoCarb_metabolomics$PptID)
BactoCarb_Metab$PptID
colnames(BactoCarb_Metab)
# first metabolites begins on column 21 and ends with column 262
#colnames(BactoCarb_Metab[262])
#log transforming propionate
log_propionate <- log(BactoCarb_Metab$Propionate)
#adding it to the dataframe
BactoCarb_Metab$log_propionate <- log_propionate
BactoCarb_Metab$log_propionate
# log transforming fat
log_fat_gr <- log(BactoCarb_Metab$Fat_g_)
#add it to the dataframe
BactoCarb_Metab$log_fat_gr <- log_fat_gr
mylm <- lmer(log_propionate ~ log_fat_gr+ diet_0A_1B + diet_seq_0AB_1BA + batch_f + female_0no_1yes+ + age + (1|PptID), data=BactoCarb_Metab)
#log transforming propionate
log_propionate <- log(BactoCarb_Metab$Propionate)
#adding it to the dataframe
BactoCarb_Metab$log_propionate <- log_propionate
BactoCarb_Metab$log_propionate
# log transforming fat
log_fat_gr <- log(BactoCarb_Metab$Fat_g_)
#add it to the dataframe
BactoCarb_Metab$log_fat_gr <- log_fat_gr
mylm <- lmer(log_propionate ~ log_fat_gr+ diet_0A_1B + diet_seq_0AB_1BA + batch_f + female_0no_1yes+ + age + (1|PptID), data=BactoCarb_Metab)
mylm <- lmer(log_propionate ~ log_fat_gr+ diet_0A_1B + diet_seq_0AB_1BA + batch_f + female_0no_1yes+ + age + (1|PptID), data=BactoCarb_Metab)
batch_f <- factor(BactoCarb_Metab$batch, levels = c("1", "2", "3", "4", "5", "6", "7", "8", "9","10"), labels = c("1","2","3","4","5","6","7","8","9","10"))
BactoCarb_Metab$batch_f <- batch_f
mylm <- lmer(log_propionate ~ log_fat_gr+ diet_0A_1B + diet_seq_0AB_1BA + batch_f + female_0no_1yes+ + age + (1|PptID), data=BactoCarb_Metab)
mylm
summary        <- summary(mylm)$coefficients
summary
mylm <- lmer(log_propionate ~ log_fat_gr+ diet_0A_1B + diet_seq_0AB_1BA + batch_f + female_0no_1yes+ + age + (1|PptID), data=BactoCarb_Metab)
mylm
summary        <- summary(mylm)$coefficients
summary
